<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Gallery</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="min-h-full w-full bg-white p-4 md:p-6">
    <div id="app"></div>
    <script>
        const productsData = [
            {
                id: 1,
                name: "Classic Leather Sneakers",
                variants: [
                    {
                        id: 1,
                        name: "White",
                        images: [
                            { url: "https://images.unsplash.com/photo-1600269452121-4f2416e55c28?ixlib=rb-4.0.3", alt: "White sneaker front view" },
                            { url: "https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?ixlib=rb-4.0.3", alt: "White sneaker side view" },
                            { url: "https://images.unsplash.com/photo-1603808033192-082d6919d3e1?ixlib=rb-4.0.3", alt: "White sneaker back view" }
                        ],
                        affiliateLinks: [
                            { name: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_icon.svg", url: "#", price: "$9.99" },
                            { name: "Nike", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Logo_NIKE.svg", url: "#", price: "$89.99" },
                            { name: "Footlocker", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Foot_Locker_logo.svg", url: "#", price: "$94.99" }
                        ]
                    },
                    {
                        id: 2,
                        name: "Black",
                        images: [
                            { url: "https://images.unsplash.com/photo-1491553895911-0055eca6402d?ixlib=rb-4.0.3", alt: "Black sneaker front view" },
                            { url: "https://images.unsplash.com/photo-1607522370275-f14206abe5d3?ixlib=rb-4.0.3", alt: "Black sneaker side view" },
                            { url: "https://images.unsplash.com/photo-1608231387042-66d1773070a5?ixlib=rb-4.0.3", alt: "Black sneaker back view" }
                        ],
                        affiliateLinks: [
                            { name: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_icon.svg", url: "#", price: "$99.99" },
                            { name: "Nike", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Logo_NIKE.svg", url: "#", price: "$89.99" },
                            { name: "Footlocker", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Foot_Locker_logo.svg", url: "#", price: "$94.99" }
                        ]
                    }
                ]
            },
            {
                id: 2,
                name: "Classic Leather Sneakers",
                variants: [
                    {
                        id: 1,
                        name: "White",
                        images: [
                            { url: "https://images.unsplash.com/photo-1600269452121-4f2416e55c28?ixlib=rb-4.0.3", alt: "White sneaker front view" },
                            { url: "https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?ixlib=rb-4.0.3", alt: "White sneaker side view" },
                            { url: "https://images.unsplash.com/photo-1603808033192-082d6919d3e1?ixlib=rb-4.0.3", alt: "White sneaker back view" }
                        ],
                        affiliateLinks: [
                            { name: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_icon.svg", url: "#", price: "$99.99" },
                            { name: "Nike", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Logo_NIKE.svg", url: "#", price: "$89.99" },
                            { name: "Footlocker", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Foot_Locker_logo.svg", url: "#", price: "$94.99" }
                        ]
                    },
                    {
                        id: 2,
                        name: "Black",
                        images: [
                            { url: "https://images.unsplash.com/photo-1491553895911-0055eca6402d?ixlib=rb-4.0.3", alt: "Black sneaker front view" },
                            { url: "https://images.unsplash.com/photo-1607522370275-f14206abe5d3?ixlib=rb-4.0.3", alt: "Black sneaker side view" },
                            { url: "https://images.unsplash.com/photo-1608231387042-66d1773070a5?ixlib=rb-4.0.3", alt: "Black sneaker back view" }
                        ],
                        affiliateLinks: [
                            { name: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_icon.svg", url: "#", price: "$99.99" },
                            { name: "Nike", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Logo_NIKE.svg", url: "#", price: "$89.99" },
                            { name: "Footlocker", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Foot_Locker_logo.svg", url: "#", price: "$94.99" }
                        ]
                    }
                ]
            },
            {
                id: 3,
                name: "Classic Leather Sneakers",
                variants: [
                    {
                        id: 1,
                        name: "White",
                        images: [
                            { url: "https://images.unsplash.com/photo-1600269452121-4f2416e55c28?ixlib=rb-4.0.3", alt: "White sneaker front view" },
                            { url: "https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?ixlib=rb-4.0.3", alt: "White sneaker side view" },
                            { url: "https://images.unsplash.com/photo-1603808033192-082d6919d3e1?ixlib=rb-4.0.3", alt: "White sneaker back view" }
                        ],
                        affiliateLinks: [
                            { name: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_icon.svg", url: "#", price: "$99.99" },
                            { name: "Nike", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Logo_NIKE.svg", url: "#", price: "$89.99" },
                            { name: "Footlocker", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Foot_Locker_logo.svg", url: "#", price: "$94.99" }
                        ]
                    },
                    {
                        id: 2,
                        name: "Black",
                        images: [
                            { url: "https://images.unsplash.com/photo-1491553895911-0055eca6402d?ixlib=rb-4.0.3", alt: "Black sneaker front view" },
                            { url: "https://images.unsplash.com/photo-1607522370275-f14206abe5d3?ixlib=rb-4.0.3", alt: "Black sneaker side view" },
                            { url: "https://images.unsplash.com/photo-1608231387042-66d1773070a5?ixlib=rb-4.0.3", alt: "Black sneaker back view" }
                        ],
                        affiliateLinks: [
                            { name: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_icon.svg", url: "#", price: "$99.99" },
                            { name: "Nike", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a6/Logo_NIKE.svg", url: "#", price: "$89.99" },
                            { name: "Footlocker", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fd/Foot_Locker_logo.svg", url: "#", price: "$94.99" }
                        ]
                    }
                ]
            }
        ];

        const appContainer = document.getElementById('app');
        let selectedVariants = productsData.reduce(
            (acc, product) => ({
                ...acc,
                [product.id]: { variant: product.variants[0], currentIndex: 0 }
            }),
            {}
        );

        function handleVariantSelect(productId, variantId) {
            const product = productsData.find(p => p.id === productId);
            const variant = product.variants.find(v => v.id === variantId);
            selectedVariants[productId] = { variant, currentIndex: 0 };
            renderApp();
        }

        function renderApp() {
            appContainer.innerHTML = `
                <div class="min-h-full w-full bg-white p-4 md:p-6">
                    <div class="mx-auto max-w-7xl">
                        <div class="grid gap-8 sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3">
                            ${productsData.map(product => `
                                <div class="border rounded-xl p-4 bg-white shadow-sm">
                                    <h2 class="mb-4 text-xl font-bold">${product.name}</h2>
                                    <div class="space-y-4">
                                        <div id="gallery-${product.id}">
                                            ${createImageGalleryHTML(product.id)}
                                        </div>
                                        <div class="flex gap-2 overflow-x-auto">
                                            ${product.variants.map(variant => `
                                                <button onclick="handleVariantSelect(${product.id}, ${variant.id})" class="flex-none ${
                                                    selectedVariants[product.id].variant.id === variant.id ? "ring-2 ring-black" : ""
                                                }">
                                                    <img src="${variant.images[0].url}" alt="${variant.name}" class="h-16 w-16 rounded-md object-cover object-center" />
                                                </button>
                                            `).join('')}
                                        </div>
                                    </div>
                                     <div>
                                        <h3 class="mb-3 font-semibold">Available From</h3>
                                        <div id="affiliate-links-${product.id}" class="space-y-3">
                                            ${createAffiliateLinkHTML(product.id)}
                                        </div>
                                    </div>
                                 </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        function createAffiliateLinkHTML(productId) {
        const product = productsData.find(p => p.id === productId);
        const AffiliateLink = product.variants.find(v => v.id === selectedVariants[productId].variant.id).affiliateLinks;

        return AffiliateLink.map(link => `
          <a href="${link.url}" target="_blank" rel="noopener noreferrer" class="flex w-full items-center justify-between rounded-lg border p-3 hover:bg-gray-50">
              <div class="flex items-center gap-3">
                  <img src="${link.logo}" alt="${link.name}" class="h-8 w-8 object-contain" />
                  <span class="font-medium">${link.name}</span>
              </div>
              <span class="font-semibold">${link.price}</span>
          </a>
        `).join('');
      }

        function createImageGalleryHTML(productId) {
            const { variant, currentIndex } = selectedVariants[productId];
            const images = variant.images;

            const indicatorsHTML = images.map((_, index) => `
                <button class="w-2 h-2 rounded-full transition-all ${currentIndex === index ? "bg-black" : "bg-gray-300"}"
                        aria-label="Go to image ${index + 1}" onclick="updateGallery(${productId}, ${index})">
                </button>
            `).join('');

            return `
                <div class="relative w-full" style="aspect-ratio:1/1">
                    <div class="relative aspect-square overflow-hidden rounded-lg bg-gray-100">
                        <img src="${images[currentIndex].url}" alt="${images[currentIndex].alt}" class="h-full w-full object-cover object-center" />
                        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center gap-2">${indicatorsHTML}</div>
                        <button class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full" aria-label="Previous"
                                onclick="prevImage(${productId})">&#9664;</button>
                        <button class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full" aria-label="Next"
                                onclick="nextImage(${productId})">&#9654;</button>
                    </div>
                </div>
            `;
        }

        function updateGallery(productId, index) {
            selectedVariants[productId].currentIndex = index;
            document.getElementById(`gallery-${productId}`).innerHTML = createImageGalleryHTML(productId);
        }

        function prevImage(productId) {
            const variantData = selectedVariants[productId];
            variantData.currentIndex = (variantData.currentIndex - 1 + variantData.variant.images.length) % variantData.variant.images.length;
            updateGallery(productId, variantData.currentIndex);
        }

        function nextImage(productId) {
            const variantData = selectedVariants[productId];
            variantData.currentIndex = (variantData.currentIndex + 1) % variantData.variant.images.length;
            updateGallery(productId, variantData.currentIndex);
        }

        renderApp();
    </script>
</body>
</html>
